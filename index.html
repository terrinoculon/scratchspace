<html>

	<head>
		<title>
			Scratch
		</title>
	</head>

	<body  bgcolor="#333">

		<center>
			<img name="example1" src="./frames_for_demo/frame32.jpg" width="60%"/>
			<br>
			<br>
			<canvas height="250" id="imgCanvas" width="250"></canvas>
<br>
<p>Idle Download : <output id="result"></output> % complete.. </p>
		</center>
		<script language="JavaScript" type="text/javascript">
		var base="http://terrinoculon.github.io/scratchspace/frames_for_demo/frame";
		// for (var i = 0; i < 2500; ++i) {
		//      var img = new Image();
		//      img.src = base.concat(i.toString(),".png");
		// 		 var ii=i/25;
		//
		//   }
		var list=[];
		var canvas = document.getElementById("imgCanvas");
		canvas.width=250;
		canvas.height=250;
		mr=50;
		mc=50;
		var posX;
		var posY;var idx=1;
		var context = canvas.getContext('2d');
		canvas.addEventListener('mousemove',getMousePos, true);

		function createImageOnCanvas(imageId) {}
		context.fillStyle = "#666666";
		context.fillRect(0, 0, canvas.width, canvas.height);
		ct=32;
		function getMousePos( evt) {
			var rect = canvas.getBoundingClientRect();
			posX= (evt.clientX-rect.left)/(rect.right-rect.left)*canvas.width;
		  posY= (evt.clientY-rect.top)/(rect.bottom-rect.top)*canvas.height;
		  posx = Math.ceil((posX+1)/5);
			posy = Math.ceil((posY+1)/5);
				// Erase canvas
				// Erase canvas
				context.fillStyle = "#666666";
				context.fillRect(0, 0, canvas.width, canvas.height);
				// Draw a circle particle on the canvas
				context.beginPath();
				context.fillStyle = "#E59420";
				// After setting the fill style, draw an arc on the canvas
				context.arc(posX, posY, 10, 0, Math.PI * 2, true);
				context.closePath();context.fill();
		    ct= (posy + mr * (posx - 1)) ;
				if (list.indexOf(ct)==-1)
				{
					list.push(ct);
				}
				document.example1.src=base.concat(ct.toString(),".jpg");
				var bufferSize=0;
				for (var i=-bufferSize;i<bufferSize;i++)
				{
					for (var j=-bufferSize;j<bufferSize;j++)
					{
						var tmp= (posy+j + mr * (posx+i - 1)) ;
						if ((list.indexOf(tmp)==-1) && (tmp<2501) && (tmp>0) )
						{
							list.push(tmp);
							var img = new Image();
							img.src = base.concat(tmp.toString(),".jpg");
						}
					}

				}


		}
		if (window.Worker) {
			var myWorker = new Worker("worker.js");
			console.log('Created Worker');
			myWorker.onmessage = function(e) {
				document.getElementById("result").innerHTML = e.data;
				console.log('Message received from worker');
	};}
	else{
		document.getElementById("result").innerHTML = 'Failed';
		console.log('No Workers');
	}

			</script>
	</body>

</html>
